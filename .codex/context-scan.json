{
  "scan_timestamp": "2025-11-26T00:15:00Z",
  "entries": [
    {
      "scope": "职业分类基准库增强",
      "location": "cmd/classifier/main.go",
      "current_state": "命令行工具读取 classification.json，将缺失的 LLM 岗位概述/职责/关键词/典型岗位通过火山方舟 deepseek-v3 模型批量补全；支持并发、重试、强制重刷、限量处理，结果再写回 JSON。",
      "similar_examples": [
        "cmd/jobimport/main.go: DataProcessor.getEmbeddingText 依赖这些增强字段拼接语料",
        "docs/CLASSIFICATION_GUIDE.md: 旧版 Excel -> JSON 工具，说明职分类数据来源"
      ],
      "tech_stack": [
        "Go 1.24",
        "火山 Engine OpenAI-Compatible Chat API",
        "JSON 流水线 + 本地文件"
      ],
      "tests_or_validation": "无自动化测试；通过日志统计和写回 JSON 的人工复核。"
    },
    {
      "scope": "职业向量入库",
      "location": "cmd/jobimport/main.go",
      "current_state": "Ollama 本地 quentinz/bge-large-zh-v1.5 生成 1024 维向量，做 L2 归一化后批量写入本地 ChromaDB cosine 集合；导入前自动清理/重建集合并批量写入 metadata。",
      "similar_examples": [
        "cmd/query/main.go: normalizeEmbedding + 查询流程复用同一嵌入模型",
        "docs/IMPORT_GUIDE.md: 描述 jobs.db 抽样导入策略，可作为 Chroma 入库的上游"
      ],
      "tech_stack": [
        "Ollama embeddings",
        "ChromaDB HTTP v2 API",
        "Go 并发批处理（batchSize=50）"
      ],
      "tests_or_validation": "仅通过日志输出和 Chroma count API 进行人工确认，无单测。"
    },
    {
      "scope": "招聘 JD 结构化",
      "location": "cmd/importer/main.go",
      "current_state": "SQLite jobs 表中 `job_intro` 为空的记录通过本地 Ollama qwen2:7b-instruct 转换为结构化 JSON 字段，包含岗位概述/职责/技能/行业/地点/大类提示，并写回多列。",
      "similar_examples": [
        "cmd/query/main.go: formatStructuredText 将结构化结果回填到查询文本",
        "docs/IMPORT_GUIDE.md: 说明 jobs.db 数据来源与表结构"
      ],
      "tech_stack": [
        "SQLite (WAL)",
        "Ollama chat API",
        "Go 多协程 workerCount=10"
      ],
      "tests_or_validation": "依靠日志追踪和数据库字段校验，暂无自动化测试。"
    },
    {
      "scope": "JD 匹配",
      "location": "cmd/query/main.go",
      "current_state": "遍历 jobs.db 中全部 JD，将结构化文本+原文拼接后通过 Ollama 生成单位向量，调用 Chroma 查询 2000 条候选，以 1-distance 做 similarity，写入 CSV 并以 0.55 阈值筛选匹配。",
      "similar_examples": [
        "cmd/jobimport/main.go: normalizeEmbedding、ChromaRepository.Query/Add 逻辑类似",
        "cmd/importer/main.go: 结构化 JSON 提供的 Summary/Responsibilities 复用"
      ],
      "tech_stack": [
        "Ollama embeddings",
        "ChromaDB cosine 查询",
        "SQLite 数据源 + CSV 输出"
      ],
      "tests_or_validation": "手动运行并检查 result/*.csv；未实现自动精度评估。"
    }
  ],
  "observation_report": [
    "docs/CLASSIFICATION_GUIDE.md 仍描述旧版 Excel -> JSON 流程，与当前 cmd/classifier 逻辑不符，需要更新文档或保留旧工具代码。",
    "仓库缺乏任何单元/集成测试，精度评估完全依赖手工抽查，无法量化改进。",
    "嵌入与查询都直接调用 Ollama，本地模型性能和显存成为瓶颈；无缓存/批量接口会放大延迟。",
    "没有看到基于 ground-truth 的准确率统计或混淆矩阵，难以判断优化成果。",
    "未找到 code-index 工具入口，本次通过 rg/sed 直接阅读源码。"
  ]
}
